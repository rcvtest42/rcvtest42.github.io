<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mbed TLS v3.0.0: gcm.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mbed TLS v3.0.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_b4d146e9a6d8dd56ed4afb2480a97fd3.html">mbedtls</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">gcm.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains GCM definitions and functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="private__access_8h_source.html">mbedtls/private_access.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="build__info_8h_source.html">mbedtls/build_info.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cipher_8h_source.html">mbedtls/cipher.h</a>&quot;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for gcm.h:</div>
<div class="dyncontent">
<div class="center"><img src="gcm_8h__incl.png" border="0" usemap="#agcm_8h" alt=""/></div>
<map name="agcm_8h" id="agcm_8h">
<area shape="rect" title="This file contains GCM definitions and functions." alt="" coords="148,5,211,32"/>
<area shape="rect" href="private__access_8h.html" title="Macro wrapper for struct&#39;s memebrs." alt="" coords="28,155,216,181"/>
<area shape="rect" href="build__info_8h.html" title="Build&#45;time configuration info." alt="" coords="288,304,442,331"/>
<area shape="rect" href="cipher_8h.html" title="This file contains an abstraction interface for use with the cipher primitives provided by the librar..." alt="" coords="181,80,312,107"/>
<area shape="rect" title=" " alt="" coords="336,80,407,107"/>
<area shape="rect" href="mbedtls__config_8h.html" title="Configuration options (set of defines)" alt="" coords="167,379,358,405"/>
<area shape="rect" href="check__config_8h.html" title="Consistency checks for configuration options." alt="" coords="382,379,556,405"/>
<area shape="rect" title=" " alt="" coords="434,453,504,480"/>
<area shape="rect" title=" " alt="" coords="292,229,366,256"/>
<area shape="rect" href="platform__util_8h.html" title="Common and shared functions used by multiple modules in the Mbed TLS library." alt="" coords="343,155,518,181"/>
<area shape="rect" href="platform__time_8h.html" title="mbed TLS Platform time abstraction" alt="" coords="441,229,625,256"/>
<area shape="rect" title=" " alt="" coords="538,304,602,331"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="gcm_8h__dep__incl.png" border="0" usemap="#agcm_8hdep" alt=""/></div>
<map name="agcm_8hdep" id="agcm_8hdep">
<area shape="rect" title="This file contains GCM definitions and functions." alt="" coords="33,5,96,32"/>
<area shape="rect" href="crypto__struct_8h.html" title="PSA cryptography module: Mbed TLS structured type implementations." alt="" coords="5,80,124,107"/>
<area shape="rect" href="crypto_8h.html" title="Platform Security Architecture cryptography module." alt="" coords="27,155,102,181"/>
</map>
</div>
</div>
<p><a href="gcm_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The GCM context structure.  <a href="structmbedtls__gcm__context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a023326dceb6d25c6d0c8a383f8748e86"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#a023326dceb6d25c6d0c8a383f8748e86">MBEDTLS_GCM_ENCRYPT</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a023326dceb6d25c6d0c8a383f8748e86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a792b42066d6fac0a85d547f5c9c5636a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#a792b42066d6fac0a85d547f5c9c5636a">MBEDTLS_GCM_DECRYPT</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a792b42066d6fac0a85d547f5c9c5636a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ed179bbaac5f312fb1235d33db3f6c4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#a4ed179bbaac5f312fb1235d33db3f6c4">MBEDTLS_ERR_GCM_AUTH_FAILED</a>&#160;&#160;&#160;-0x0012</td></tr>
<tr class="separator:a4ed179bbaac5f312fb1235d33db3f6c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77153ba10a2c9d428bdb1fb02076429e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#a77153ba10a2c9d428bdb1fb02076429e">MBEDTLS_ERR_GCM_BAD_INPUT</a>&#160;&#160;&#160;-0x0014</td></tr>
<tr class="separator:a77153ba10a2c9d428bdb1fb02076429e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a2bbc4e9c67469520b7fcf16ef8a5442f"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#a2bbc4e9c67469520b7fcf16ef8a5442f">mbedtls_gcm_context</a></td></tr>
<tr class="memdesc:a2bbc4e9c67469520b7fcf16ef8a5442f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The GCM context structure.  <a href="gcm_8h.html#a2bbc4e9c67469520b7fcf16ef8a5442f">More...</a><br /></td></tr>
<tr class="separator:a2bbc4e9c67469520b7fcf16ef8a5442f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac3f60a663c6b01ef6d977ac06aac57df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#ac3f60a663c6b01ef6d977ac06aac57df">mbedtls_gcm_init</a> (<a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *ctx)</td></tr>
<tr class="memdesc:ac3f60a663c6b01ef6d977ac06aac57df"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes the specified GCM context, to make references valid, and prepares the context for <a class="el" href="gcm_8h.html#ae87d2c58882a11976fdc6a30f6f0ae6f" title="This function associates a GCM context with a cipher algorithm and a key.">mbedtls_gcm_setkey()</a> or <a class="el" href="gcm_8h.html#af09c2638d0ff09880517231df34d346f" title="This function clears a GCM context and the underlying cipher sub-context.">mbedtls_gcm_free()</a>.  <a href="gcm_8h.html#ac3f60a663c6b01ef6d977ac06aac57df">More...</a><br /></td></tr>
<tr class="separator:ac3f60a663c6b01ef6d977ac06aac57df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae87d2c58882a11976fdc6a30f6f0ae6f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#ae87d2c58882a11976fdc6a30f6f0ae6f">mbedtls_gcm_setkey</a> (<a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *ctx, <a class="el" href="cipher_8h.html#af5b069ffd0b2ad31225e42ee4ee29b1b">mbedtls_cipher_id_t</a> cipher, const unsigned char *key, unsigned int keybits)</td></tr>
<tr class="memdesc:ae87d2c58882a11976fdc6a30f6f0ae6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function associates a GCM context with a cipher algorithm and a key.  <a href="gcm_8h.html#ae87d2c58882a11976fdc6a30f6f0ae6f">More...</a><br /></td></tr>
<tr class="separator:ae87d2c58882a11976fdc6a30f6f0ae6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ad456f90f60211f72005dc815b808b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#a3ad456f90f60211f72005dc815b808b5">mbedtls_gcm_crypt_and_tag</a> (<a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *ctx, int mode, size_t length, const unsigned char *iv, size_t iv_len, const unsigned char *add, size_t add_len, const unsigned char *input, unsigned char *output, size_t tag_len, unsigned char *tag)</td></tr>
<tr class="memdesc:a3ad456f90f60211f72005dc815b808b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs GCM encryption or decryption of a buffer.  <a href="gcm_8h.html#a3ad456f90f60211f72005dc815b808b5">More...</a><br /></td></tr>
<tr class="separator:a3ad456f90f60211f72005dc815b808b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af264b64b26c4720188b530cfccddb4ef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#af264b64b26c4720188b530cfccddb4ef">mbedtls_gcm_auth_decrypt</a> (<a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *ctx, size_t length, const unsigned char *iv, size_t iv_len, const unsigned char *add, size_t add_len, const unsigned char *tag, size_t tag_len, const unsigned char *input, unsigned char *output)</td></tr>
<tr class="memdesc:af264b64b26c4720188b530cfccddb4ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs a GCM authenticated decryption of a buffer.  <a href="gcm_8h.html#af264b64b26c4720188b530cfccddb4ef">More...</a><br /></td></tr>
<tr class="separator:af264b64b26c4720188b530cfccddb4ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4fc445b5f0c8d32d51c550efd19d00a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#ab4fc445b5f0c8d32d51c550efd19d00a">mbedtls_gcm_starts</a> (<a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *ctx, int mode, const unsigned char *iv, size_t iv_len)</td></tr>
<tr class="memdesc:ab4fc445b5f0c8d32d51c550efd19d00a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function starts a GCM encryption or decryption operation.  <a href="gcm_8h.html#ab4fc445b5f0c8d32d51c550efd19d00a">More...</a><br /></td></tr>
<tr class="separator:ab4fc445b5f0c8d32d51c550efd19d00a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa45cca22fcfad8eca56d5abae689282c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#aa45cca22fcfad8eca56d5abae689282c">mbedtls_gcm_update_ad</a> (<a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *ctx, const unsigned char *add, size_t add_len)</td></tr>
<tr class="memdesc:aa45cca22fcfad8eca56d5abae689282c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function feeds an input buffer as associated data (authenticated but not encrypted data) in a GCM encryption or decryption operation.  <a href="gcm_8h.html#aa45cca22fcfad8eca56d5abae689282c">More...</a><br /></td></tr>
<tr class="separator:aa45cca22fcfad8eca56d5abae689282c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26c0bf4fe8227582e93be477e626ec32"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#a26c0bf4fe8227582e93be477e626ec32">mbedtls_gcm_update</a> (<a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *ctx, const unsigned char *input, size_t input_length, unsigned char *output, size_t output_size, size_t *output_length)</td></tr>
<tr class="memdesc:a26c0bf4fe8227582e93be477e626ec32"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function feeds an input buffer into an ongoing GCM encryption or decryption operation.  <a href="gcm_8h.html#a26c0bf4fe8227582e93be477e626ec32">More...</a><br /></td></tr>
<tr class="separator:a26c0bf4fe8227582e93be477e626ec32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2deda922efc2119c70d4ab6f5b6dc1de"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#a2deda922efc2119c70d4ab6f5b6dc1de">mbedtls_gcm_finish</a> (<a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *ctx, unsigned char *output, size_t output_size, size_t *output_length, unsigned char *tag, size_t tag_len)</td></tr>
<tr class="memdesc:a2deda922efc2119c70d4ab6f5b6dc1de"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finishes the GCM operation and generates the authentication tag.  <a href="gcm_8h.html#a2deda922efc2119c70d4ab6f5b6dc1de">More...</a><br /></td></tr>
<tr class="separator:a2deda922efc2119c70d4ab6f5b6dc1de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af09c2638d0ff09880517231df34d346f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#af09c2638d0ff09880517231df34d346f">mbedtls_gcm_free</a> (<a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *ctx)</td></tr>
<tr class="memdesc:af09c2638d0ff09880517231df34d346f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function clears a GCM context and the underlying cipher sub-context.  <a href="gcm_8h.html#af09c2638d0ff09880517231df34d346f">More...</a><br /></td></tr>
<tr class="separator:af09c2638d0ff09880517231df34d346f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af08f4690bdc542d366494d13422fa7a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8h.html#af08f4690bdc542d366494d13422fa7a3">mbedtls_gcm_self_test</a> (int verbose)</td></tr>
<tr class="memdesc:af08f4690bdc542d366494d13422fa7a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The GCM checkup routine.  <a href="gcm_8h.html#af08f4690bdc542d366494d13422fa7a3">More...</a><br /></td></tr>
<tr class="separator:af08f4690bdc542d366494d13422fa7a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains GCM definitions and functions. </p>
<p>The Galois/Counter Mode (GCM) for 128-bit block ciphers is defined in <em>D. McGrew, J. Viega, The Galois/Counter Mode of Operation (GCM), Natl. Inst. Stand. Technol.</em></p>
<p>For more information on GCM, see <em>NIST SP 800-38D: Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC</em>. </p>

<p class="definition">Definition in file <a class="el" href="gcm_8h_source.html">gcm.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a4ed179bbaac5f312fb1235d33db3f6c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ed179bbaac5f312fb1235d33db3f6c4">&#9670;&nbsp;</a></span>MBEDTLS_ERR_GCM_AUTH_FAILED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_GCM_AUTH_FAILED&#160;&#160;&#160;-0x0012</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Authenticated decryption failed. </p>

<p class="definition">Definition at line <a class="el" href="gcm_8h_source.html#l00044">44</a> of file <a class="el" href="gcm_8h_source.html">gcm.h</a>.</p>

</div>
</div>
<a id="a77153ba10a2c9d428bdb1fb02076429e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77153ba10a2c9d428bdb1fb02076429e">&#9670;&nbsp;</a></span>MBEDTLS_ERR_GCM_BAD_INPUT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_GCM_BAD_INPUT&#160;&#160;&#160;-0x0014</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bad input parameters to function. </p>

<p class="definition">Definition at line <a class="el" href="gcm_8h_source.html#l00045">45</a> of file <a class="el" href="gcm_8h_source.html">gcm.h</a>.</p>

</div>
</div>
<a id="a792b42066d6fac0a85d547f5c9c5636a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a792b42066d6fac0a85d547f5c9c5636a">&#9670;&nbsp;</a></span>MBEDTLS_GCM_DECRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_GCM_DECRYPT&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcm_8h_source.html#l00042">42</a> of file <a class="el" href="gcm_8h_source.html">gcm.h</a>.</p>

</div>
</div>
<a id="a023326dceb6d25c6d0c8a383f8748e86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a023326dceb6d25c6d0c8a383f8748e86">&#9670;&nbsp;</a></span>MBEDTLS_GCM_ENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_GCM_ENCRYPT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcm_8h_source.html#l00041">41</a> of file <a class="el" href="gcm_8h_source.html">gcm.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a2bbc4e9c67469520b7fcf16ef8a5442f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bbc4e9c67469520b7fcf16ef8a5442f">&#9670;&nbsp;</a></span>mbedtls_gcm_context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> <a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The GCM context structure. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="af264b64b26c4720188b530cfccddb4ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af264b64b26c4720188b530cfccddb4ef">&#9670;&nbsp;</a></span>mbedtls_gcm_auth_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_gcm_auth_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iv_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>add_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>tag_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs a GCM authenticated decryption of a buffer. </p>
<dl class="section note"><dt>Note</dt><dd>For decryption, the output buffer cannot be the same as input buffer. If the buffers overlap, the output buffer must trail at least 8 Bytes behind the input buffer.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The GCM context. This must be initialized. </td></tr>
    <tr><td class="paramname">length</td><td>The length of the ciphertext to decrypt, which is also the length of the decrypted plaintext. </td></tr>
    <tr><td class="paramname">iv</td><td>The initialization vector. This must be a readable buffer of at least <code>iv_len</code> Bytes. </td></tr>
    <tr><td class="paramname">iv_len</td><td>The length of the IV. </td></tr>
    <tr><td class="paramname">add</td><td>The buffer holding the additional data. This must be of at least that size in Bytes. </td></tr>
    <tr><td class="paramname">add_len</td><td>The length of the additional data. </td></tr>
    <tr><td class="paramname">tag</td><td>The buffer holding the tag to verify. This must be a readable buffer of at least <code>tag_len</code> Bytes. </td></tr>
    <tr><td class="paramname">tag_len</td><td>The length of the tag to verify. </td></tr>
    <tr><td class="paramname">input</td><td>The buffer holding the ciphertext. If <code>length</code> is greater than zero, this must be a readable buffer of at least that size. </td></tr>
    <tr><td class="paramname">output</td><td>The buffer for holding the decrypted plaintext. If <code>length</code> is greater than zero, this must be a writable buffer of at least that size.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> if successful and authenticated. </dd>
<dd>
<a class="el" href="gcm_8h.html#a4ed179bbaac5f312fb1235d33db3f6c4">MBEDTLS_ERR_GCM_AUTH_FAILED</a> if the tag does not match. </dd>
<dd>
<a class="el" href="gcm_8h.html#a77153ba10a2c9d428bdb1fb02076429e">MBEDTLS_ERR_GCM_BAD_INPUT</a> if the lengths or pointers are not valid or a cipher-specific error code if the decryption failed. </dd></dl>

</div>
</div>
<a id="a3ad456f90f60211f72005dc815b808b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ad456f90f60211f72005dc815b808b5">&#9670;&nbsp;</a></span>mbedtls_gcm_crypt_and_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_gcm_crypt_and_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iv_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>add_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>tag_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs GCM encryption or decryption of a buffer. </p>
<dl class="section note"><dt>Note</dt><dd>For encryption, the output buffer can be the same as the input buffer. For decryption, the output buffer cannot be the same as input buffer. If the buffers overlap, the output buffer must trail at least 8 Bytes behind the input buffer.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>When this function performs a decryption, it outputs the authentication tag and does not verify that the data is authentic. You should use this function to perform encryption only. For decryption, use <a class="el" href="gcm_8h.html#af264b64b26c4720188b530cfccddb4ef" title="This function performs a GCM authenticated decryption of a buffer.">mbedtls_gcm_auth_decrypt()</a> instead.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The GCM context to use for encryption or decryption. This must be initialized. </td></tr>
    <tr><td class="paramname">mode</td><td>The operation to perform:<ul>
<li><a class="el" href="gcm_8h.html#a023326dceb6d25c6d0c8a383f8748e86">MBEDTLS_GCM_ENCRYPT</a> to perform authenticated encryption. The ciphertext is written to <code>output</code> and the authentication tag is written to <code>tag</code>.</li>
<li><a class="el" href="gcm_8h.html#a792b42066d6fac0a85d547f5c9c5636a">MBEDTLS_GCM_DECRYPT</a> to perform decryption. The plaintext is written to <code>output</code> and the authentication tag is written to <code>tag</code>. Note that this mode is not recommended, because it does not verify the authenticity of the data. For this reason, you should use <a class="el" href="gcm_8h.html#af264b64b26c4720188b530cfccddb4ef" title="This function performs a GCM authenticated decryption of a buffer.">mbedtls_gcm_auth_decrypt()</a> instead of calling this function in decryption mode. </li>
</ul>
</td></tr>
    <tr><td class="paramname">length</td><td>The length of the input data, which is equal to the length of the output data. </td></tr>
    <tr><td class="paramname">iv</td><td>The initialization vector. This must be a readable buffer of at least <code>iv_len</code> Bytes. </td></tr>
    <tr><td class="paramname">iv_len</td><td>The length of the IV. </td></tr>
    <tr><td class="paramname">add</td><td>The buffer holding the additional data. This must be of at least that size in Bytes. </td></tr>
    <tr><td class="paramname">add_len</td><td>The length of the additional data. </td></tr>
    <tr><td class="paramname">input</td><td>The buffer holding the input data. If <code>length</code> is greater than zero, this must be a readable buffer of at least that size in Bytes. </td></tr>
    <tr><td class="paramname">output</td><td>The buffer for holding the output data. If <code>length</code> is greater than zero, this must be a writable buffer of at least that size in Bytes. </td></tr>
    <tr><td class="paramname">tag_len</td><td>The length of the tag to generate. </td></tr>
    <tr><td class="paramname">tag</td><td>The buffer for holding the tag. This must be a writable buffer of at least <code>tag_len</code> Bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> if the encryption or decryption was performed successfully. Note that in <a class="el" href="gcm_8h.html#a792b42066d6fac0a85d547f5c9c5636a">MBEDTLS_GCM_DECRYPT</a> mode, this does not indicate that the data is authentic. </dd>
<dd>
<a class="el" href="gcm_8h.html#a77153ba10a2c9d428bdb1fb02076429e">MBEDTLS_ERR_GCM_BAD_INPUT</a> if the lengths or pointers are not valid or a cipher-specific error code if the encryption or decryption failed. </dd></dl>

</div>
</div>
<a id="a2deda922efc2119c70d4ab6f5b6dc1de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2deda922efc2119c70d4ab6f5b6dc1de">&#9670;&nbsp;</a></span>mbedtls_gcm_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_gcm_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>tag_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finishes the GCM operation and generates the authentication tag. </p>
<p>It wraps up the GCM stream, and generates the tag. The tag can have a maximum length of 16 Bytes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The GCM context. This must be initialized. </td></tr>
    <tr><td class="paramname">tag</td><td>The buffer for holding the tag. This must be a writable buffer of at least <code>tag_len</code> Bytes. </td></tr>
    <tr><td class="paramname">tag_len</td><td>The length of the tag to generate. This must be at least four. </td></tr>
    <tr><td class="paramname">output</td><td>The buffer for the final output. If <code>output_size</code> is nonzero, this must be a writable buffer of at least <code>output_size</code> bytes. </td></tr>
    <tr><td class="paramname">output_size</td><td>The size of the <code>output</code> buffer in bytes. This must be large enough for the output that <a class="el" href="gcm_8h.html#a26c0bf4fe8227582e93be477e626ec32" title="This function feeds an input buffer into an ongoing GCM encryption or decryption operation.">mbedtls_gcm_update()</a> has not produced. In particular:<ul>
<li>If <a class="el" href="gcm_8h.html#a26c0bf4fe8227582e93be477e626ec32" title="This function feeds an input buffer into an ongoing GCM encryption or decryption operation.">mbedtls_gcm_update()</a> produces immediate output, or if the total input size is a multiple of <code>16</code>, then <a class="el" href="gcm_8h.html#a2deda922efc2119c70d4ab6f5b6dc1de" title="This function finishes the GCM operation and generates the authentication tag.">mbedtls_gcm_finish()</a> never produces any output, so <code>output_size</code> can be <code>0</code>.</li>
<li><code>output_size</code> never needs to be more than <code>15</code>. </li>
</ul>
</td></tr>
    <tr><td class="paramname">output_length</td><td>On success, <code>*output_length</code> contains the actual length of the output written in <code>output</code>. On failure, the content of <code>*output_length</code> is unspecified.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="gcm_8h.html#a77153ba10a2c9d428bdb1fb02076429e">MBEDTLS_ERR_GCM_BAD_INPUT</a> on failure: invalid value of <code>tag_len</code>, or <code>output_size</code> too small. </dd></dl>

</div>
</div>
<a id="af09c2638d0ff09880517231df34d346f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af09c2638d0ff09880517231df34d346f">&#9670;&nbsp;</a></span>mbedtls_gcm_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_gcm_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function clears a GCM context and the underlying cipher sub-context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The GCM context to clear. If this is <code>NULL</code>, the call has no effect. Otherwise, this must be initialized. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac3f60a663c6b01ef6d977ac06aac57df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3f60a663c6b01ef6d977ac06aac57df">&#9670;&nbsp;</a></span>mbedtls_gcm_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_gcm_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes the specified GCM context, to make references valid, and prepares the context for <a class="el" href="gcm_8h.html#ae87d2c58882a11976fdc6a30f6f0ae6f" title="This function associates a GCM context with a cipher algorithm and a key.">mbedtls_gcm_setkey()</a> or <a class="el" href="gcm_8h.html#af09c2638d0ff09880517231df34d346f" title="This function clears a GCM context and the underlying cipher sub-context.">mbedtls_gcm_free()</a>. </p>
<p>The function does not bind the GCM context to a particular cipher, nor set the key. For this purpose, use <a class="el" href="gcm_8h.html#ae87d2c58882a11976fdc6a30f6f0ae6f" title="This function associates a GCM context with a cipher algorithm and a key.">mbedtls_gcm_setkey()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The GCM context to initialize. This must not be <code>NULL</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af08f4690bdc542d366494d13422fa7a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af08f4690bdc542d366494d13422fa7a3">&#9670;&nbsp;</a></span>mbedtls_gcm_self_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_gcm_self_test </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The GCM checkup routine. </p>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<code>1</code> on failure. </dd></dl>

</div>
</div>
<a id="ae87d2c58882a11976fdc6a30f6f0ae6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae87d2c58882a11976fdc6a30f6f0ae6f">&#9670;&nbsp;</a></span>mbedtls_gcm_setkey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_gcm_setkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cipher_8h.html#af5b069ffd0b2ad31225e42ee4ee29b1b">mbedtls_cipher_id_t</a>&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>keybits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function associates a GCM context with a cipher algorithm and a key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The GCM context. This must be initialized. </td></tr>
    <tr><td class="paramname">cipher</td><td>The 128-bit block cipher to use. </td></tr>
    <tr><td class="paramname">key</td><td>The encryption key. This must be a readable buffer of at least <code>keybits</code> bits. </td></tr>
    <tr><td class="paramname">keybits</td><td>The key size in bits. Valid options are: <ul>
<li>
128 bits </li>
<li>
192 bits </li>
<li>
256 bits</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
A cipher-specific error code on failure. </dd></dl>

</div>
</div>
<a id="ab4fc445b5f0c8d32d51c550efd19d00a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4fc445b5f0c8d32d51c550efd19d00a">&#9670;&nbsp;</a></span>mbedtls_gcm_starts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_gcm_starts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iv_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function starts a GCM encryption or decryption operation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The GCM context. This must be initialized. </td></tr>
    <tr><td class="paramname">mode</td><td>The operation to perform: <a class="el" href="gcm_8h.html#a023326dceb6d25c6d0c8a383f8748e86">MBEDTLS_GCM_ENCRYPT</a> or <a class="el" href="gcm_8h.html#a792b42066d6fac0a85d547f5c9c5636a">MBEDTLS_GCM_DECRYPT</a>. </td></tr>
    <tr><td class="paramname">iv</td><td>The initialization vector. This must be a readable buffer of at least <code>iv_len</code> Bytes. </td></tr>
    <tr><td class="paramname">iv_len</td><td>The length of the IV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd></dl>

</div>
</div>
<a id="a26c0bf4fe8227582e93be477e626ec32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26c0bf4fe8227582e93be477e626ec32">&#9670;&nbsp;</a></span>mbedtls_gcm_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_gcm_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function feeds an input buffer into an ongoing GCM encryption or decryption operation. </p>
<p>You may call this function zero, one or more times to pass successive parts of the input: the plaintext to encrypt, or the ciphertext (not including the tag) to decrypt. After the last part of the input, call <a class="el" href="gcm_8h.html#a2deda922efc2119c70d4ab6f5b6dc1de" title="This function finishes the GCM operation and generates the authentication tag.">mbedtls_gcm_finish()</a>.</p>
<p>This function may produce output in one of the following ways:</p><ul>
<li>Immediate output: the output length is always equal to the input length.</li>
<li>Buffered output: the output consists of a whole number of 16-byte blocks. If the total input length so far (not including associated data) is 16 * <em>B</em> + <em>A</em> with <em>A</em> &lt; 16 then the total output length is 16 * <em>B</em>.</li>
</ul>
<p>In particular:</p><ul>
<li>It is always correct to call this function with <code>output_size</code> &gt;= <code>input_length</code> + 15.</li>
<li>If <code>input_length</code> is a multiple of 16 for all the calls to this function during an operation, then it is correct to use <code>output_size</code> = <code>input_length</code>.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>For decryption, the output buffer cannot be the same as input buffer. If the buffers overlap, the output buffer must trail at least 8 Bytes behind the input buffer.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The GCM context. This must be initialized. </td></tr>
    <tr><td class="paramname">input</td><td>The buffer holding the input data. If <code>input_length</code> is greater than zero, this must be a readable buffer of at least <code>input_length</code> bytes. </td></tr>
    <tr><td class="paramname">input_length</td><td>The length of the input data in bytes. </td></tr>
    <tr><td class="paramname">output</td><td>The buffer for the output data. If <code>output_size</code> is greater than zero, this must be a writable buffer of of at least <code>output_size</code> bytes. </td></tr>
    <tr><td class="paramname">output_size</td><td>The size of the output buffer in bytes. See the function description regarding the output size. </td></tr>
    <tr><td class="paramname">output_length</td><td>On success, <code>*output_length</code> contains the actual length of the output written in <code>output</code>. On failure, the content of <code>*output_length</code> is unspecified.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="gcm_8h.html#a77153ba10a2c9d428bdb1fb02076429e">MBEDTLS_ERR_GCM_BAD_INPUT</a> on failure: total input length too long, unsupported input/output buffer overlap detected, or <code>output_size</code> too small. </dd></dl>

</div>
</div>
<a id="aa45cca22fcfad8eca56d5abae689282c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa45cca22fcfad8eca56d5abae689282c">&#9670;&nbsp;</a></span>mbedtls_gcm_update_ad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_gcm_update_ad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__gcm__context.html">mbedtls_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>add_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function feeds an input buffer as associated data (authenticated but not encrypted data) in a GCM encryption or decryption operation. </p>
<p>Call this function after <a class="el" href="gcm_8h.html#ab4fc445b5f0c8d32d51c550efd19d00a" title="This function starts a GCM encryption or decryption operation.">mbedtls_gcm_starts()</a> to pass the associated data. If the associated data is empty, you do not need to call this function. You may not call this function after calling <a class="el" href="cipher_8h.html#a959598dfef9d7f2add8861e0c518f303" title="The generic cipher update function. It encrypts or decrypts using the given cipher context....">mbedtls_cipher_update()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The GCM context. This must have been started with <a class="el" href="gcm_8h.html#ab4fc445b5f0c8d32d51c550efd19d00a" title="This function starts a GCM encryption or decryption operation.">mbedtls_gcm_starts()</a> and must not have yet received any input with <a class="el" href="gcm_8h.html#a26c0bf4fe8227582e93be477e626ec32" title="This function feeds an input buffer into an ongoing GCM encryption or decryption operation.">mbedtls_gcm_update()</a>. </td></tr>
    <tr><td class="paramname">add</td><td>The buffer holding the additional data, or <code>NULL</code> if <code>add_len</code> is <code>0</code>. </td></tr>
    <tr><td class="paramname">add_len</td><td>The length of the additional data. If <code>0</code>, <code>add</code> may be <code>NULL</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 31 2022 05:48:05 for mbed TLS v3.0.0 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
